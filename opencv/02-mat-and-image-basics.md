# 02 - 图像与 Mat 基础（最重要的一章）

## 图像在 OpenCV 里到底是什么

一句话：**图像就是一个矩阵（数组）**，每个元素是像素；彩色图像每个像素有多个通道。

- **灰度图**：H×W
- **彩色图（常见）**：H×W×3（OpenCV 默认 BGR）
- **带透明通道**：H×W×4（BGRA）

## 你必须理解的 5 个概念

### 1) 尺寸与索引

- 高 H = 行数（y）
- 宽 W = 列数（x）
- 坐标通常写成 `(x, y)`，但访问数组常是 `img[y, x]`

### 2) 通道（channels）

- BGR 三通道分别代表蓝/绿/红强度
- 通道操作常见需求：拆分/合并/转灰度

### 3) 数据类型（dtype）

最常见：

- `uint8`：0~255（多数图片读取后的默认类型）
- `float32`：做计算/归一化/滤波更安全

**新手最常踩坑**：`uint8` 上做加减乘除可能出现溢出/截断，建议：

- 算之前转 `float32`
- 或用 OpenCV 自带函数（内部会做优化与边界处理）

### 4) ROI（Region of Interest）

ROI 就是“我只看图像的一部分”。很多语言绑定里 ROI 可能是：

- **视图（不拷贝）**：修改 ROI 会影响原图（性能好）
- **拷贝**：修改 ROI 不影响原图（更安全）

实际写代码时你要明确：你需要的是“快”，还是“独立数据”。

### 5) 连续内存（isContinuous）

你会在性能优化、把 Mat 交给其他库、或自己做指针遍历时遇到：

- 连续：一整块内存
- 不连续：常见于 ROI/切片（行与行之间有步长）

**建议**：新手阶段先少写手工 for 循环，多用 OpenCV API；等你做性能/部署再深入。

## 推荐练习（10 分钟）

1. 读一张图，打印形状（H/W/通道）与 dtype
2. 取一个 ROI，画框标出来并保存
3. 把图像转成 `float32`，做一次简单归一化，再转回 `uint8` 保存

## 对应你仓库里的进阶笔记

你原来的 `opencv.md` 里已经提到了 ROI、连续/非连续、性能等要点，后面你会不断回头查：

- `opencv.md`（进阶速查/工业 pipeline）

